{% extends 'layout.html' %}

{% block content %}

 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
   integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
   crossorigin=""/>

 <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
   integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
   crossorigin=""></script>

 <style type="text/css">
    #mapa {
      width: 100%;
      height: 300px;
    }
</style>


<div class="row">
	<div class="col-md-12">
		<div class="panel panel-default">
			<div class="panel-heading">{{generador.tipo}} {{generador.caracteristicas[0]['modelo-serie']}} - Instalado en {{generador.comuna.nombre}}</div>
			<div class="panel-body">
				<div class="row">		
					<div class="col-md-3 col-md-offset-0">
						<div class="panel panel-default">
							<div class="panel-heading"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span><strong> Caracteristicas Tecnicas</strong></div>
							<div class="panel-body">
								<ul>
									{% for c in generador.caracteristicas['0'] %}
										<li> <strong>{{loop.key}}:</strong> {{c}}</li>
									{% endfor %}
								</ul>
							</div>
						</div>
					</div>

					<div class="col-md-3 col-md-offset-0">
						<div class="panel panel-default">
							<div class="panel-heading"><span class="glyphicon glyphicon-flash" aria-hidden="true"></span> <strong>Banco de Baterias</strong></div>
							<div class="panel-body">
								<ul>
									{% for b in generador.bbaterias['0'] %}
										<li> <strong>{{loop.key}}: </strong> {{b}}</li>
									{% endfor %}
								</ul>
								<br>
								<br>
								<br>
							</div>
						</div>
					</div>

					<div class="col-md-6 col-md-offset-0">
						<div class="panel panel-default">
							<div class="panel-heading"><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> <strong>Ubicacion</strong></div>
							<div class="panel-body">
								<div id="mapa"> </div>
							</div>
						</div>
					</div>
					
				</div>
			</div>
		</div>	
	</div>
</div>

<div class="row">
	<div class="col-md-8">
		<div class="panel panel-default">
			<div class="panel-heading"><span class="glyphicon glyphicon-scale" aria-hidden="true"></span> <strong>Sensores y Suscripciones</strong></div>
			<div class="panel-body">
				<table class="table table-bordered">
					<thead class="inverse">
					    <tr>
							<th class="text-center info">Sensores climaticos</th>
							<th class="text-center info">Topico</th>
						</tr>
					</thead>
					<tbody class="text-center">
						{% for c in sensoresC %}
							<tr>
								<td>{{loop.key}}</td>
								<td>{{c}}</td>
							</tr>
						{% endfor %}
						<tr>
							<th class="text-center warning">Sensores electricos</th>
							<th class="text-center warning">Topico</td>
						</tr>
						{% for p in sensoresP %}
							<tr>
								<td>{{loop.key}}</td>
								<td>{{p}}</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>

			</div>
		</div>
	</div>
</div>
<script> 
var map = L.map('mapa').setView([-42, -71], 5);

L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);

L.marker([{{generador.comuna.point_geom[0]['latitud']}}, {{generador.comuna.point_geom[0]['longitud']}}]).addTo(map)
    .bindPopup('Latitud: {{generador.comuna.point_geom[0]['latitud']}} </br> longitud: {{generador.comuna.point_geom[0]['longitud']}}')
    .openPopup();


</script>

{% endblock %}